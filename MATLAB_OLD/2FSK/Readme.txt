Note:
The MATLAB implementation should be corrected:
Reciver